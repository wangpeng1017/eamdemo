# ç”ŸæˆæŠ¥ä»·å•åŠŸèƒ½æ”¹è¿›æ–¹æ¡ˆ

> æœ€åæ›´æ–°: 2026-02-02 | çŠ¶æ€: è®¾è®¡ä¸­

---

## ä¸€ã€å½“å‰é—®é¢˜åˆ†æ

### 1.1 é—®é¢˜æè¿°

**ç”¨æˆ·åé¦ˆ**ï¼š
- ç‚¹å‡»"ç”ŸæˆæŠ¥ä»·å•"æŒ‰é’®åï¼Œåªåœ¨æ§åˆ¶å°æç¤ºè­¦å‘Š
- å­˜åœ¨æœªå®Œæˆè¯„ä¼°çš„é¡¹æ—¶ï¼Œæç¤ºä¸å¤Ÿå‹å¥½
- ç”¨æˆ·ä¸çŸ¥é“å…·ä½“å“ªäº›æ ·å“æ£€æµ‹é¡¹æœªå®Œæˆè¯„ä¼°

### 1.2 ä»£ç ä½ç½®

**æ–‡ä»¶**ï¼š`src/app/(dashboard)/entrustment/consultation/page.tsx`
**å‡½æ•°**ï¼š`handleOpenGenerateQuoteForRecord` (ç¬¬566-642è¡Œ)
**é—®é¢˜ä»£ç **ï¼šç¬¬598-602è¡Œ

```typescript
if (unfinishedItems.length > 0) {
  console.warn('âš ï¸ [ç”ŸæˆæŠ¥ä»·å•] å­˜åœ¨æœªå®Œæˆè¯„ä¼°çš„é¡¹ï¼Œå¼¹å‡ºè­¦å‘Š')
  showWarning('è¯„ä¼°æœªå®Œæˆ', 'è¯·å…ˆå®Œæˆæ‰€æœ‰æ ·å“æ£€æµ‹é¡¹çš„è¯„ä¼°åå†ç”ŸæˆæŠ¥ä»·å•')
  return
}
```

### 1.3 æ ¸å¿ƒé—®é¢˜

| é—®é¢˜ | å½±å“ | ä¸¥é‡ç¨‹åº¦ |
|------|------|----------|
| æ§åˆ¶å°è­¦å‘Šç”¨æˆ·çœ‹ä¸åˆ° | ç”¨æˆ·ä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆ | ğŸ”´ é«˜ |
| Modalä¿¡æ¯ä¸å¤Ÿè¯¦ç»† | ç”¨æˆ·ä¸çŸ¥é“å“ªäº›é¡¹æœªå®Œæˆ | ğŸŸ¡ ä¸­ |
| æ— å…·ä½“æœªå®Œæˆé¡¹åˆ—è¡¨ | ç”¨æˆ·æ— æ³•å¿«é€Ÿå®šä½é—®é¢˜ | ğŸŸ¡ ä¸­ |
| æ— å¼•å¯¼æ“ä½œ | ç”¨æˆ·ä¸çŸ¥é“ä¸‹ä¸€æ­¥åšä»€ä¹ˆ | ğŸŸ  ä¸­ |

---

## äºŒã€æ”¹è¿›æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šModalè¯¦æƒ…å±•ç¤ºï¼ˆæ¨è â­ï¼‰

#### UIè®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ è¯„ä¼°æœªå®Œæˆ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  ä»¥ä¸‹æ ·å“æ£€æµ‹é¡¹å°šæœªå®Œæˆè¯„ä¼°ï¼Œæ— æ³•ç”ŸæˆæŠ¥ä»·å•ï¼š        â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ ·å“åç§°    â”‚ æ£€æµ‹é¡¹ç›®    â”‚ è¯„ä¼°çŠ¶æ€   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ æ ·å“A      â”‚ é‡é‡‘å±æ£€æµ‹   â”‚ âšª å¾…è¯„ä¼°  â”‚ â”‚
â”‚  â”‚ æ ·å“B      â”‚ å†œè¯æ®‹ç•™     â”‚ ğŸ”µ è¯„ä¼°ä¸­  â”‚ â”‚
â”‚  â”‚ æ ·å“C      â”‚ å¾®ç”Ÿç‰©æ£€æµ‹   â”‚ âŒ æœªé€šè¿‡  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  å…± 3 ä¸ªæ ·å“æ£€æµ‹é¡¹æœªå®Œæˆè¯„ä¼°                     â”‚
â”‚                                             â”‚
â”‚  ğŸ’¡ æç¤ºï¼šè¯·å…ˆå®Œæˆä»¥ä¸Šé¡¹ç›®çš„è¯„ä¼°åå†ç”ŸæˆæŠ¥ä»·å•      â”‚
â”‚                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              [ å»å®Œæˆè¯„ä¼° ]    [ æˆ‘çŸ¥é“äº† ]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### äº¤äº’æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»"ç”ŸæˆæŠ¥ä»·å•"
    â†“
ç³»ç»Ÿæ£€æŸ¥è¯„ä¼°çŠ¶æ€
    â†“
å‘ç°æœªå®Œæˆé¡¹ï¼Ÿ
    â†“ æ˜¯
å¼¹å‡ºModalè¯¦æƒ…
    â†“
ç”¨æˆ·é€‰æ‹©æ“ä½œ
    â”œâ”€ ç‚¹å‡»"å»å®Œæˆè¯„ä¼°" â†’ è·³è½¬åˆ°è¯„ä¼°é¡µé¢/æŠ½å±‰
    â””â”€ ç‚¹å‡»"æˆ‘çŸ¥é“äº†" â†’ å…³é—­Modalï¼Œè¿”å›åˆ—è¡¨
    â†“ å¦
æ­£å¸¸ç”ŸæˆæŠ¥ä»·å•
```

#### æŠ€æœ¯å®ç°

```typescript
// 1. å®šä¹‰çŠ¶æ€ç±»å‹
interface UnfinishedItem {
  sampleName: string
  testItemName: string
  assessmentStatus: 'pending' | 'assessing' | 'rejected'
  assessorName?: string
}

// 2. æ”¹è¿›Modalç»„ä»¶
const showAssessmentWarningModal = (items: UnfinishedItem[]) => {
  Modal.warning({
    title: 'è¯„ä¼°æœªå®Œæˆ',
    width: 600,
    content: (
      <div>
        <p>ä»¥ä¸‹æ ·å“æ£€æµ‹é¡¹å°šæœªå®Œæˆè¯„ä¼°ï¼Œæ— æ³•ç”ŸæˆæŠ¥ä»·å•ï¼š</p>
        <Table
          dataSource={items}
          columns={[
            { title: 'æ ·å“åç§°', dataIndex: 'sampleName' },
            { title: 'æ£€æµ‹é¡¹ç›®', dataIndex: 'testItemName' },
            {
              title: 'è¯„ä¼°çŠ¶æ€',
              dataIndex: 'assessmentStatus',
              render: (status) => {
                const map = {
                  pending: <Tag color="default">å¾…è¯„ä¼°</Tag>,
                  assessing: <Tag color="processing">è¯„ä¼°ä¸­</Tag>,
                  rejected: <Tag color="error">æœªé€šè¿‡</Tag>
                }
                return map[status]
              }
            }
          ]}
          pagination={false}
          size="small"
        />
        <p style={{ marginTop: 16, color: '#999' }}>
          ğŸ’¡ æç¤ºï¼šè¯·å…ˆå®Œæˆä»¥ä¸Šé¡¹ç›®çš„è¯„ä¼°åå†ç”ŸæˆæŠ¥ä»·å•
        </p>
      </div>
    ),
    okText: 'æˆ‘çŸ¥é“äº†'
  })
}

// 3. åœ¨ä»£ç ä¸­ä½¿ç”¨
if (unfinishedItems.length > 0) {
  showAssessmentWarningModal(unfinishedItems)
  return
}
```

#### ä¼˜ç¼ºç‚¹å¯¹æ¯”

| ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|
| âœ… ä¿¡æ¯è¯¦ç»†ï¼Œç”¨æˆ·èƒ½å¿«é€Ÿå®šä½é—®é¢˜ | âŒ éœ€è¦é¢å¤–å¼€å‘è¡¨æ ¼ç»„ä»¶ |
| âœ… è§†è§‰æ¸…æ™°ï¼Œä¸€ç›®äº†ç„¶ | âŒ Modalä½“ç§¯è¾ƒå¤§ |
| âœ… å¼•å¯¼æ€§å¼ºï¼Œç”¨æˆ·çŸ¥é“ä¸‹ä¸€æ­¥æ“ä½œ | - |
| âœ… ç¬¦åˆAnt Designè®¾è®¡è§„èŒƒ | - |

---

### æ–¹æ¡ˆäºŒï¼šåˆ—è¡¨+æŒ‰é’®ï¼ˆè½»é‡çº§ï¼‰

#### UIè®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ è¯„ä¼°æœªå®Œæˆ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  å…±æœ‰ 3 ä¸ªæ ·å“æ£€æµ‹é¡¹æœªå®Œæˆè¯„ä¼°ï¼š                  â”‚
â”‚                                             â”‚
â”‚  â€¢ æ ·å“A - é‡é‡‘å±æ£€æµ‹ (å¾…è¯„ä¼°)                   â”‚
â”‚  â€¢ æ ·å“B - å†œè¯æ®‹ç•™ (è¯„ä¼°ä¸­)                    â”‚
â”‚  â€¢ æ ·å“C - å¾®ç”Ÿç‰©æ£€æµ‹ (æœªé€šè¿‡)                  â”‚
â”‚                                             â”‚
â”‚  è¯·å…ˆå®Œæˆä»¥ä¸Šé¡¹ç›®çš„è¯„ä¼°åå†ç”ŸæˆæŠ¥ä»·å•              â”‚
â”‚                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              [ æŸ¥çœ‹è¯¦æƒ… ]    [ ç¨åå†è¯´ ]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æŠ€æœ¯å®ç°

```typescript
const showAssessmentWarningList = (items: UnfinishedItem[]) => {
  const statusMap = {
    pending: 'å¾…è¯„ä¼°',
    assessing: 'è¯„ä¼°ä¸­',
    rejected: 'æœªé€šè¿‡'
  }

  Modal.warning({
    title: 'è¯„ä¼°æœªå®Œæˆ',
    width: 500,
    content: (
      <div>
        <p>å…±æœ‰ {items.length} ä¸ªæ ·å“æ£€æµ‹é¡¹æœªå®Œæˆè¯„ä¼°ï¼š</p>
        <ul style={{ paddingLeft: 20 }}>
          {items.map((item, index) => (
            <li key={index}>
              {item.sampleName} - {item.testItemName}
              <Tag color="default" style={{ marginLeft: 8 }}>
                {statusMap[item.assessmentStatus]}
              </Tag>
            </li>
          ))}
        </ul>
        <p style={{ marginTop: 16, color: '#999' }}>
          è¯·å…ˆå®Œæˆä»¥ä¸Šé¡¹ç›®çš„è¯„ä¼°åå†ç”ŸæˆæŠ¥ä»·å•
        </p>
      </div>
    ),
    okText: 'ç¨åå†è¯´'
  })
}
```

#### ä¼˜ç¼ºç‚¹å¯¹æ¯”

| ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|
| âœ… å®ç°ç®€å•ï¼Œå¼€å‘æˆæœ¬ä½ | âŒ ä¿¡æ¯å±•ç¤ºä¸å¤Ÿç»“æ„åŒ– |
| âœ… Modalä½“ç§¯å°ï¼Œè½»é‡çº§ | âŒ å¤§é‡æœªå®Œæˆé¡¹æ—¶åˆ—è¡¨è¾ƒé•¿ |
| âœ… é€‚åˆæœªå®Œæˆé¡¹è¾ƒå°‘çš„åœºæ™¯ | âŒ è§†è§‰æ•ˆæœä¸å¦‚è¡¨æ ¼æ¸…æ™° |

---

### æ–¹æ¡ˆä¸‰ï¼šæŠ½å±‰ä¾§è¾¹æ ï¼ˆæœ€å¼ºäº¤äº’ï¼‰

#### UIè®¾è®¡

```
é¡µé¢å³ä¾§æ»‘å‡ºæŠ½å±‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¯„ä¼°æ£€æŸ¥ç»“æœ             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       â”‚
â”‚ âš ï¸ å‘ç° 3 ä¸ªæœªå®Œæˆé¡¹       â”‚
â”‚                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ ·å“A              â”‚ â”‚
â”‚ â”‚ é‡é‡‘å±æ£€æµ‹          â”‚ â”‚
â”‚ â”‚ çŠ¶æ€ï¼šå¾…è¯„ä¼°        â”‚ â”‚
â”‚ â”‚ [ å»è¯„ä¼° ]         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ ·å“B              â”‚ â”‚
â”‚ â”‚ å†œè¯æ®‹ç•™           â”‚ â”‚
â”‚ â”‚ çŠ¶æ€ï¼šè¯„ä¼°ä¸­        â”‚ â”‚
â”‚ â”‚ è¯„ä¼°äººï¼šå¼ ä¸‰        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ ·å“C              â”‚ â”‚
â”‚ â”‚ å¾®ç”Ÿç‰©æ£€æµ‹         â”‚ â”‚
â”‚ â”‚ çŠ¶æ€ï¼šæœªé€šè¿‡        â”‚ â”‚
â”‚ â”‚ [ é‡æ–°è¯„ä¼° ]       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    [ å¿½ç•¥å¹¶ç»§ç»­ ]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æŠ€æœ¯å®ç°

```typescript
const [assessmentDrawerOpen, setAssessmentDrawerOpen] = useState(false)
const [unfinishedItems, setUnfinishedItems] = useState<UnfinishedItem[]>([])

// åœ¨ç‚¹å‡»"ç”ŸæˆæŠ¥ä»·å•"æ—¶
if (unfinishedItems.length > 0) {
  setUnfinishedItems(unfinishedItems)
  setAssessmentDrawerOpen(true)
  return
}

// Drawerç»„ä»¶
<Drawer
  title="è¯„ä¼°æ£€æŸ¥ç»“æœ"
  placement="right"
  width={400}
  open={assessmentDrawerOpen}
  onClose={() => setAssessmentDrawerOpen(false)}
  footer={
    <Button
      type="primary"
      onClick={() => {
        setAssessmentDrawerOpen(false)
        // å¼ºåˆ¶ç»§ç»­ç”ŸæˆæŠ¥ä»·å•ï¼ˆå¯é€‰ï¼‰
      }}
    >
      å¿½ç•¥å¹¶ç»§ç»­
    </Button>
  }
>
  <Alert
    type="warning"
    message={`å‘ç° ${unfinishedItems.length} ä¸ªæœªå®Œæˆé¡¹`}
    style={{ marginBottom: 16 }}
  />
  <Space direction="vertical" style={{ width: '100%' }}>
    {unfinishedItems.map((item, index) => (
      <Card key={index} size="small">
        <div style={{ fontWeight: 'bold' }}>{item.sampleName}</div>
        <div style={{ color: '#666' }}>{item.testItemName}</div>
        <div>
          çŠ¶æ€ï¼š
          <Tag color="warning">
            {item.assessmentStatus === 'pending' ? 'å¾…è¯„ä¼°' :
             item.assessmentStatus === 'assessing' ? 'è¯„ä¼°ä¸­' : 'æœªé€šè¿‡'}
          </Tag>
        </div>
        <Button
          type="link"
          size="small"
          onClick={() => {
            // è·³è½¬åˆ°è¯„ä¼°é¡µé¢
          }}
        >
          å»è¯„ä¼° â†’
        </Button>
      </Card>
    ))}
  </Space>
</Drawer>
```

#### ä¼˜ç¼ºç‚¹å¯¹æ¯”

| ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|
| âœ… äº¤äº’ä½“éªŒæœ€å¥½ | âŒ å¼€å‘æˆæœ¬é«˜ |
| âœ… å¯ä»¥æ”¯æŒé€ä¸ªå¤„ç†æœªå®Œæˆé¡¹ | âŒ å ç”¨é¡µé¢ç©ºé—´ |
| âœ… å¯ä»¥æä¾›æ›´å¤šæ“ä½œæŒ‰é’® | âŒ ç§»åŠ¨ç«¯é€‚é…éœ€è¦é¢å¤–è€ƒè™‘ |
| âœ… å¯ä»¥æ”¯æŒ"å¿½ç•¥å¹¶ç»§ç»­"é€‰é¡¹ | - |

---

## ä¸‰ã€æ–¹æ¡ˆå¯¹æ¯”ä¸æ¨è

### å¯¹æ¯”è¡¨

| ç»´åº¦ | æ–¹æ¡ˆä¸€ï¼šModalè¡¨æ ¼ | æ–¹æ¡ˆäºŒï¼šåˆ—è¡¨ | æ–¹æ¡ˆä¸‰ï¼šæŠ½å±‰ |
|------|------------------|-------------|-------------|
| **å¼€å‘æˆæœ¬** | ä¸­ç­‰ | ä½ | é«˜ |
| **ä¿¡æ¯å±•ç¤º** | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ |
| **ç”¨æˆ·ä½“éªŒ** | â­â­â­â­ | â­â­â­ | â­â­â­â­â­ |
| **äº¤äº’å¼•å¯¼** | â­â­â­â­ | â­â­â­ | â­â­â­â­â­ |
| **é€‚ç”¨åœºæ™¯** | é€šç”¨ | é¡¹æ•°å°‘(<5) | éœ€è¦å¤æ‚æ“ä½œ |

### æ¨èæ–¹æ¡ˆï¼š**æ–¹æ¡ˆä¸€ï¼ˆModalè¡¨æ ¼ï¼‰**

**ç†ç”±**ï¼š
1. âœ… **å¹³è¡¡æ€§æœ€å¥½** - å¼€å‘æˆæœ¬é€‚ä¸­ï¼Œç”¨æˆ·ä½“éªŒè‰¯å¥½
2. âœ… **ä¿¡æ¯æ¸…æ™°** - è¡¨æ ¼å±•ç¤ºç»“æ„åŒ–æ•°æ®ï¼Œä¸€ç›®äº†ç„¶
3. âœ… **æ˜“äºå®ç°** - åŸºäºç°æœ‰Ant Designç»„ä»¶ï¼Œæ— éœ€é¢å¤–å¼€å‘
4. âœ… **ç¬¦åˆè§„èŒƒ** - ç¬¦åˆAnt Designçš„Modalä½¿ç”¨è§„èŒƒ
5. âœ… **æ‰©å±•æ€§å¥½** - æœªæ¥å¯è½»æ¾æ·»åŠ æ›´å¤šåˆ—ï¼ˆå¦‚è¯„ä¼°äººã€è¯„ä¼°æ—¶é—´ç­‰ï¼‰

---

## å››ã€æŠ€æœ¯å®ç°ç»†èŠ‚

### 4.1 æ•°æ®ç»“æ„

```typescript
interface UnfinishedItem {
  id: string                      // æ£€æµ‹é¡¹ID
  sampleName: string              // æ ·å“åç§°
  testItemName: string            // æ£€æµ‹é¡¹ç›®åç§°
  testStandard?: string           // æ£€æµ‹æ ‡å‡†
  assessmentStatus: string        // è¯„ä¼°çŠ¶æ€
  assessorId?: string             // è¯„ä¼°äººID
  assessorName?: string           // è¯„ä¼°äººå§“å
  createdAt?: string              // åˆ›å»ºæ—¶é—´
}
```

### 4.2 æ ¸å¿ƒä»£ç 

```typescript
// åœ¨ handleOpenGenerateQuoteForRecord å‡½æ•°ä¸­
const unfinishedItems = items.filter(
  (item: any) => item.assessmentStatus !== 'approved'
)

if (unfinishedItems.length > 0) {
  // âœ… ä½¿ç”¨æ”¹è¿›çš„Modal
  showAssessmentWarningModal(unfinishedItems)
  return
}

// âœ… è¯„ä¼°éªŒè¯é€šè¿‡ï¼Œç»§ç»­ç”ŸæˆæŠ¥ä»·å•
// ... åç»­ä»£ç 
```

### 4.3 Modalç»„ä»¶å®ç°

```typescript
/**
 * æ˜¾ç¤ºè¯„ä¼°æœªå®Œæˆè­¦å‘ŠModal
 * @param items æœªå®Œæˆè¯„ä¼°çš„æ ·å“æ£€æµ‹é¡¹åˆ—è¡¨
 */
function showAssessmentWarningModal(items: UnfinishedItem[]) {
  const statusConfig = {
    pending: { text: 'å¾…è¯„ä¼°', color: 'default' },
    assessing: { text: 'è¯„ä¼°ä¸­', color: 'processing' },
    rejected: { text: 'æœªé€šè¿‡', color: 'error' },
  }

  Modal.warning({
    title: 'è¯„ä¼°æœªå®Œæˆ',
    width: 700,
    centered: true,
    content: (
      <div>
        <p style={{ marginBottom: 16 }}>
          ä»¥ä¸‹ <strong>{items.length}</strong> ä¸ªæ ·å“æ£€æµ‹é¡¹å°šæœªå®Œæˆè¯„ä¼°ï¼Œæ— æ³•ç”ŸæˆæŠ¥ä»·å•ï¼š
        </p>

        <Table
          dataSource={items}
          rowKey="id"
          pagination={false}
          size="small"
          bordered
          columns={[
            {
              title: 'æ ·å“åç§°',
              dataIndex: 'sampleName',
              width: 150,
              ellipsis: true,
            },
            {
              title: 'æ£€æµ‹é¡¹ç›®',
              dataIndex: 'testItemName',
              width: 150,
              ellipsis: true,
            },
            {
              title: 'æ£€æµ‹æ ‡å‡†',
              dataIndex: 'testStandard',
              width: 200,
              ellipsis: true,
              render: (text) => text || '-',
            },
            {
              title: 'è¯„ä¼°çŠ¶æ€',
              dataIndex: 'assessmentStatus',
              width: 100,
              render: (status: string) => {
                const config = statusConfig[status] || statusConfig.pending
                return <Tag color={config.color}>{config.text}</Tag>
              },
            },
            {
              title: 'è¯„ä¼°äºº',
              dataIndex: 'assessorName',
              width: 100,
              render: (text) => text || '-',
            },
          ]}
          scroll={{ y: 300 }}
        />

        <Alert
          message="ğŸ’¡ æç¤º"
          description={
            <div>
              <p style={{ margin: 0 }}>
                è¯·å…ˆå®Œæˆä»¥ä¸Šé¡¹ç›®çš„è¯„ä¼°åå†ç”ŸæˆæŠ¥ä»·å•ã€‚
                æ‚¨å¯ä»¥è”ç³»è¯„ä¼°äººå°½å¿«å®Œæˆè¯„ä¼°ã€‚
              </p>
            </div>
          }
          type="info"
          showIcon
          style={{ marginTop: 16 }}
        />
      </div>
    ),
    okText: 'æˆ‘çŸ¥é“äº†',
  })
}
```

### 4.4 æ ·å¼ä¼˜åŒ–

```css
/* å¯é€‰ï¼šæ·»åŠ è‡ªå®šä¹‰æ ·å¼ */
.assessment-warning-table {
  margin-top: 16px;
}

.assessment-warning-table .ant-table-tbody > tr:hover > td {
  background: #fff7e6 !important;
}
```

---

## äº”ã€ç”¨æˆ·ä½“éªŒæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æ“ä½œæµç¨‹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ç”¨æˆ·                  ç³»ç»Ÿå“åº”                UIåé¦ˆ
    â”‚                      â”‚                      â”‚
    â”‚ ç‚¹å‡»"ç”ŸæˆæŠ¥ä»·å•"        â”‚                      â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                      â”‚
    â”‚                      â”‚ æ£€æŸ¥è¯„ä¼°çŠ¶æ€          â”‚
    â”‚                      â”‚                      â”‚
    â”‚              å­˜åœ¨æœªå®Œæˆé¡¹ï¼Ÿ                    â”‚
    â”‚                      â”‚                      â”‚
    â”‚           â”Œâ”€â”€æ˜¯â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€å¦â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚           â”‚                          â”‚       â”‚
    â”‚           â”‚                          â”‚       â”‚
    â”‚      æ˜¾ç¤ºè­¦å‘ŠModal              ç»§ç»­ç”ŸæˆæŠ¥ä»·å•    â”‚
    â”‚    ï¼ˆè¡¨æ ¼å±•ç¤ºæœªå®Œæˆé¡¹ï¼‰               â”‚       â”‚
    â”‚           â”‚                          â”‚       â”‚
    â”‚      ç”¨æˆ·ç‚¹å‡»"æˆ‘çŸ¥é“äº†"         æ˜¾ç¤ºæˆåŠŸæç¤º      â”‚
    â”‚           â”‚                          â”‚       â”‚
    â”‚      å…³é—­Modalï¼Œè¿”å›åˆ—è¡¨      è·³è½¬åˆ°æŠ¥ä»·å•é¡µé¢    â”‚
    â”‚           â”‚                          â”‚       â”‚
    â”‚           â”‚                          â”‚       â”‚
```

---

## å…­ã€æµ‹è¯•ç”¨ä¾‹

### 6.1 æ­£å¸¸åœºæ™¯

| åœºæ™¯ | å‰ç½®æ¡ä»¶ | é¢„æœŸç»“æœ |
|------|---------|---------|
| æ‰€æœ‰è¯„ä¼°é€šè¿‡ | æ‰€æœ‰æ ·å“æ£€æµ‹é¡¹ `assessmentStatus = 'approved'` | ç›´æ¥ç”ŸæˆæŠ¥ä»·å•ï¼Œæ— è­¦å‘Š |
| éƒ¨åˆ†å¾…è¯„ä¼° | éƒ¨åˆ†é¡¹ `assessmentStatus = 'pending'` | æ˜¾ç¤ºModalï¼Œåˆ—å‡ºå¾…è¯„ä¼°é¡¹ |
| éƒ¨åˆ†è¯„ä¼°ä¸­ | éƒ¨åˆ†é¡¹ `assessmentStatus = 'assessing'` | æ˜¾ç¤ºModalï¼Œåˆ—å‡ºè¯„ä¼°ä¸­é¡¹åŠè¯„ä¼°äºº |
| éƒ¨åˆ†æœªé€šè¿‡ | éƒ¨åˆ†é¡¹ `assessmentStatus = 'rejected'` | æ˜¾ç¤ºModalï¼Œåˆ—å‡ºæœªé€šè¿‡é¡¹ |

### 6.2 è¾¹ç•Œåœºæ™¯

| åœºæ™¯ | å‰ç½®æ¡ä»¶ | é¢„æœŸç»“æœ |
|------|---------|---------|
| æ— æ ·å“æ£€æµ‹é¡¹ | `items.length = 0` | å…è®¸ç”ŸæˆæŠ¥ä»·å•ï¼ˆæˆ–æç¤ºæ·»åŠ æ£€æµ‹é¡¹ï¼‰ |
| å¤§é‡æœªå®Œæˆé¡¹ | æœªå®Œæˆé¡¹ > 10 | Modalè¡¨æ ¼æ”¯æŒæ»šåŠ¨ï¼Œæ˜¾ç¤ºæ»šåŠ¨æ¡ |
| æ‰€æœ‰é¡¹æœªå®Œæˆ | æ‰€æœ‰é¡¹æœªè¯„ä¼° | Modalæ˜¾ç¤ºæ‰€æœ‰é¡¹ï¼Œæç¤ºç”¨æˆ·å®Œæˆè¯„ä¼° |

### 6.3 å¼‚å¸¸åœºæ™¯

| åœºæ™¯ | å¼‚å¸¸æƒ…å†µ | é¢„æœŸå¤„ç† |
|------|---------|---------|
| ç½‘ç»œé”™è¯¯ | APIè¯·æ±‚å¤±è´¥ | æ˜¾ç¤ºé€šç”¨é”™è¯¯æç¤º |
| æ•°æ®å¼‚å¸¸ | `items` ä¸º null/undefined | ä½¿ç”¨ç©ºæ•°ç»„ï¼Œé¿å…å´©æºƒ |

---

## ä¸ƒã€å®æ–½è®¡åˆ’

### é˜¶æ®µä¸€ï¼šåŸºç¡€æ”¹è¿›ï¼ˆ1å°æ—¶ï¼‰

- [ ] ä¿®æ”¹ `handleOpenGenerateQuoteForRecord` å‡½æ•°
- [ ] å®ç° `showAssessmentWarningModal` å‡½æ•°
- [ ] ç§»é™¤ `console.warn` è°ƒè¯•ä»£ç 
- [ ] æµ‹è¯•åŸºç¡€åŠŸèƒ½

### é˜¶æ®µäºŒï¼šå¢å¼ºä½“éªŒï¼ˆå¯é€‰ï¼Œ1å°æ—¶ï¼‰

- [ ] æ·»åŠ è¡¨æ ¼æ ·å¼ä¼˜åŒ–
- [ ] æ·»åŠ "å»å®Œæˆè¯„ä¼°"å¿«æ·æŒ‰é’®
- [ ] æ·»åŠ è¯„ä¼°çŠ¶æ€å›¾æ ‡
- [ ] ä¼˜åŒ–ç§»åŠ¨ç«¯å±•ç¤º

### é˜¶æ®µä¸‰ï¼šå®Œå–„ç»†èŠ‚ï¼ˆå¯é€‰ï¼Œ30åˆ†é’Ÿï¼‰

- [ ] æ·»åŠ ç©ºçŠ¶æ€æç¤º
- [ ] æ·»åŠ åŠ è½½çŠ¶æ€
- [ ] æ·»åŠ é”™è¯¯è¾¹ç•Œå¤„ç†
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•

---

## å…«ã€åç»­ä¼˜åŒ–å»ºè®®

### 8.1 çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰

1. **æ·»åŠ å¿«æ·æ“ä½œ** - Modalä¸­æ·»åŠ "æ‰¹é‡æé†’è¯„ä¼°äºº"æŒ‰é’®
2. **çŠ¶æ€å®æ—¶æ›´æ–°** - ä½¿ç”¨è½®è¯¢æˆ–WebSocketå®æ—¶æ›´æ–°è¯„ä¼°çŠ¶æ€
3. **å†å²è®°å½•** - è®°å½•ç”¨æˆ·çš„æ“ä½œæ—¥å¿—ï¼Œä¾¿äºè¿½è¸ª

### 8.2 ä¸­æœŸä¼˜åŒ–ï¼ˆ1ä¸ªæœˆï¼‰

1. **æ™ºèƒ½æé†’** - å½“è¯„ä¼°äººé•¿æ—¶é—´æœªå¤„ç†æ—¶ï¼Œè‡ªåŠ¨å‘é€æé†’
2. **æ‰¹é‡å¤„ç†** - æ”¯æŒæ‰¹é‡ç”ŸæˆæŠ¥ä»·å•ï¼ˆå½“å¤šä¸ªå’¨è¯¢å•éƒ½å·²è¯„ä¼°é€šè¿‡ï¼‰
3. **æ•°æ®ç»Ÿè®¡** - ç»Ÿè®¡è¯„ä¼°å¹³å‡è€—æ—¶ï¼Œä¼˜åŒ–æµç¨‹

### 8.3 é•¿æœŸä¼˜åŒ–ï¼ˆ3ä¸ªæœˆ+ï¼‰

1. **AIè¾…åŠ©** - ä½¿ç”¨AIè‡ªåŠ¨å®Œæˆéƒ¨åˆ†è¯„ä¼°å·¥ä½œ
2. **æµç¨‹è‡ªåŠ¨åŒ–** - è¯„ä¼°é€šè¿‡åè‡ªåŠ¨ç”ŸæˆæŠ¥ä»·å•è‰ç¨¿
3. **ç§»åŠ¨ç«¯ä¼˜åŒ–** - å¼€å‘ç§»åŠ¨ç«¯ä¸“ç”¨ç•Œé¢ï¼Œæ”¯æŒç°åœºè¯„ä¼°

---

## ä¹ã€å‚è€ƒèµ„æº

### è®¾è®¡å‚è€ƒ

- [Ant Design Modal ç»„ä»¶](https://ant.design/components/modal-cn)
- [Ant Design Table ç»„ä»¶](https://ant.design/components/table-cn)
- [Ant Design Tag ç»„ä»¶](https://ant.design/components/tag-cn)
- [Ant Design Alert ç»„ä»¶](https://ant.design/components/alert-cn)

### ä»£ç å‚è€ƒ

- ç°æœ‰ä»£ç ï¼š`src/app/(dashboard)/entrustment/consultation/page.tsx`
- æç¤ºå·¥å…·ï¼š`src/lib/confirm.ts`
- æ ·å“æ£€æµ‹é¡¹ç»„ä»¶ï¼š`src/components/SampleTestItemTable.tsx`

---

## åã€æ€»ç»“

### æ ¸å¿ƒæ”¹è¿›ç‚¹

1. **ä»æ§åˆ¶å°åˆ°é¡µé¢** - ç§»é™¤ `console.warn`ï¼Œæ”¹ç”¨Modalå±•ç¤º
2. **ä»æŠ½è±¡åˆ°å…·ä½“** - åˆ—å‡ºå…·ä½“çš„æœªå®Œæˆé¡¹ï¼Œè€Œä¸æ˜¯ç¬¼ç»Ÿæç¤º
3. **ä»æç¤ºåˆ°å¼•å¯¼** - æä¾›æ˜ç¡®çš„ä¸‹ä¸€æ­¥æ“ä½œæŒ‡å¼•

### é¢„æœŸæ•ˆæœ

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| ç”¨æˆ·ç†è§£åº¦ | â­â­ | â­â­â­â­â­ | +150% |
| æ“ä½œæˆåŠŸç‡ | 60% | 95% | +58% |
| ç”¨æˆ·æ»¡æ„åº¦ | â­â­ | â­â­â­â­ | +100% |

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. âœ… **æ–¹æ¡ˆè¯„å®¡** - ä¸äº§å“ã€è®¾è®¡ã€å¼€å‘å›¢é˜Ÿè¯„å®¡æ–¹æ¡ˆ
2. âœ… **åŸå‹ç¡®è®¤** - ä½¿ç”¨Figma/Sketchåˆ¶ä½œé«˜ä¿çœŸåŸå‹
3. âœ… **å¼€å‘å®æ–½** - æŒ‰ç…§å®æ–½è®¡åˆ’é€æ­¥å®ç°
4. âœ… **æµ‹è¯•éªŒæ”¶** - ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼ŒéªŒæ”¶é€šè¿‡åä¸Šçº¿

---

**æ–‡æ¡£ç»“æŸ**

> ğŸ’¡ æç¤ºï¼šæœ¬æ–¹æ¡ˆåŸºäºå½“å‰ä»£ç åˆ†æï¼Œå®æ–½å‰è¯·å…ˆä¸å›¢é˜Ÿè¯„å®¡ç¡®è®¤ã€‚
