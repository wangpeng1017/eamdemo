/**
 * @file basic-data-mock.ts
 * @desc 基础数据模块模拟数据
 * @input 依赖: 类型定义
 * @output 导出: 模拟数据数组
 */

import {
  CategoryNode,
  MasterDataRecord,
  DataStandard,
  SyncLog,
  DataQualityReport,
  EquipmentCategoryType,
  MasterDataStatus,
  DataSourceSystem,
  DataStandardType,
  StandardStatus,
  categoryTypeMap,
  masterDataStatusMap,
  dataSourceSystemMap,
} from '@/lib/basic-data-types'

const now = new Date().toISOString()

/**
 * 设备分类树数据
 * 按工艺、按功能、按规格三个维度组织
 */
export const mockCategoryTree: CategoryNode[] = [
  {
    id: 'CAT001',
    key: 'process-root',
    title: '按工艺分类',
    type: 'process',
    code: 'PROC',
    level: 0,
    parentId: null,
    description: '按照生产工艺流程对设备进行分类',
    equipmentCount: 45,
    active: true,
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: now,
    children: [
      {
        id: 'CAT001-01',
        key: 'process-1',
        title: '机械加工',
        type: 'process',
        code: 'PROC-01',
        level: 1,
        parentId: 'CAT001',
        description: '各类机械加工设备',
        equipmentCount: 15,
        active: true,
        createdAt: '2024-01-01T00:00:00.000Z',
        updatedAt: now,
        children: [
          {
            id: 'CAT001-01-01',
            key: 'process-1-1',
            title: '车床',
            type: 'process',
            code: 'PROC-01-01',
            level: 2,
            parentId: 'CAT001-01',
            description: '车削加工设备',
            equipmentCount: 6,
            active: true,
            createdAt: '2024-01-01T00:00:00.000Z',
            updatedAt: now,
          },
          {
            id: 'CAT001-01-02',
            key: 'process-1-2',
            title: '铣床',
            type: 'process',
            code: 'PROC-01-02',
            level: 2,
            parentId: 'CAT001-01',
            description: '铣削加工设备',
            equipmentCount: 5,
            active: true,
            createdAt: '2024-01-01T00:00:00.000Z',
            updatedAt: now,
          },
          {
            id: 'CAT001-01-03',
            key: 'process-1-3',
            title: '磨床',
            type: 'process',
            code: 'PROC-01-03',
            level: 2,
            parentId: 'CAT001-01',
            description: '磨削加工设备',
            equipmentCount: 4,
            active: true,
            createdAt: '2024-01-01T00:00:00.000Z',
            updatedAt: now,
          },
        ],
      },
      {
        id: 'CAT001-02',
        key: 'process-2',
        title: '成型加工',
        type: 'process',
        code: 'PROC-02',
        level: 1,
        parentId: 'CAT001',
        description: '各类成型加工设备',
        equipmentCount: 12,
        active: true,
        createdAt: '2024-01-01T00:00:00.000Z',
        updatedAt: now,
        children: [
          {
            id: 'CAT001-02-01',
            key: 'process-2-1',
            title: '注塑机',
            type: 'process',
            code: 'PROC-02-01',
            level: 2,
            parentId: 'CAT001-02',
            description: '塑料注塑成型设备',
            equipmentCount: 7,
            active: true,
            createdAt: '2024-01-01T00:00:00.000Z',
            updatedAt: now,
          },
          {
            id: 'CAT001-02-02',
            key: 'process-2-2',
            title: '冲压机',
            type: 'process',
            code: 'PROC-02-02',
            level: 2,
            parentId: 'CAT001-02',
            description: '金属冲压成型设备',
            equipmentCount: 5,
            active: true,
            createdAt: '2024-01-01T00:00:00.000Z',
            updatedAt: now,
          },
        ],
      },
      {
        id: 'CAT001-03',
        key: 'process-3',
        title: '焊接装配',
        type: 'process',
        code: 'PROC-03',
        level: 1,
        parentId: 'CAT001',
        description: '焊接与装配设备',
        equipmentCount: 18,
        active: true,
        createdAt: '2024-01-01T00:00:00.000Z',
        updatedAt: now,
        children: [
          {
            id: 'CAT001-03-01',
            key: 'process-3-1',
            title: '焊接机器人',
            type: 'process',
            code: 'PROC-03-01',
            level: 2,
            parentId: 'CAT001-03',
            description: '自动化焊接设备',
            equipmentCount: 10,
            active: true,
            createdAt: '2024-01-01T00:00:00.000Z',
            updatedAt: now,
          },
          {
            id: 'CAT001-03-02',
            key: 'process-3-2',
            title: '装配线',
            type: 'process',
            code: 'PROC-03-02',
            level: 2,
            parentId: 'CAT001-03',
            description: '产品装配流水线',
            equipmentCount: 8,
            active: true,
            createdAt: '2024-01-01T00:00:00.000Z',
            updatedAt: now,
          },
        ],
      },
    ],
  },
  {
    id: 'CAT002',
    key: 'function-root',
    title: '按功能分类',
    type: 'function',
    code: 'FUNC',
    level: 0,
    parentId: null,
    description: '按照设备功能对设备进行分类',
    equipmentCount: 38,
    active: true,
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: now,
    children: [
      {
        id: 'CAT002-01',
        key: 'function-1',
        title: '生产设备',
        type: 'function',
        code: 'FUNC-01',
        level: 1,
        parentId: 'CAT002',
        description: '直接用于产品生产的设备',
        equipmentCount: 22,
        active: true,
        createdAt: '2024-01-01T00:00:00.000Z',
        updatedAt: now,
        children: [
          {
            id: 'CAT002-01-01',
            key: 'function-1-1',
            title: '核心设备',
            type: 'function',
            code: 'FUNC-01-01',
            level: 2,
            parentId: 'CAT002-01',
            description: '关键生产设备',
            equipmentCount: 12,
            active: true,
            createdAt: '2024-01-01T00:00:00.000Z',
            updatedAt: now,
          },
          {
            id: 'CAT002-01-02',
            key: 'function-1-2',
            title: '辅助设备',
            type: 'function',
            code: 'FUNC-01-02',
            level: 2,
            parentId: 'CAT002-01',
            description: '生产辅助设备',
            equipmentCount: 10,
            active: true,
            createdAt: '2024-01-01T00:00:00.000Z',
            updatedAt: now,
          },
        ],
      },
      {
        id: 'CAT002-02',
        key: 'function-2',
        title: '检测设备',
        type: 'function',
        code: 'FUNC-02',
        level: 1,
        parentId: 'CAT002',
        description: '质量检测与测量设备',
        equipmentCount: 10,
        active: true,
        createdAt: '2024-01-01T00:00:00.000Z',
        updatedAt: now,
      },
      {
        id: 'CAT002-03',
        key: 'function-3',
        title: '运输设备',
        type: 'function',
        code: 'FUNC-03',
        level: 1,
        parentId: 'CAT002',
        description: '物料运输与搬运设备',
        equipmentCount: 6,
        active: true,
        createdAt: '2024-01-01T00:00:00.000Z',
        updatedAt: now,
      },
    ],
  },
  {
    id: 'CAT003',
    key: 'spec-root',
    title: '按规格分类',
    type: 'specification',
    code: 'SPEC',
    level: 0,
    parentId: null,
    description: '按照设备规格参数对设备进行分类',
    equipmentCount: 52,
    active: true,
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: now,
    children: [
      {
        id: 'CAT003-01',
        key: 'spec-1',
        title: '大型设备',
        type: 'specification',
        code: 'SPEC-01',
        level: 1,
        parentId: 'CAT003',
        description: '重量≥10吨或功率≥100kW的设备',
        equipmentCount: 18,
        active: true,
        createdAt: '2024-01-01T00:00:00.000Z',
        updatedAt: now,
      },
      {
        id: 'CAT003-02',
        key: 'spec-2',
        title: '中型设备',
        type: 'specification',
        code: 'SPEC-02',
        level: 1,
        parentId: 'CAT003',
        description: '重量1-10吨或功率10-100kW的设备',
        equipmentCount: 24,
        active: true,
        createdAt: '2024-01-01T00:00:00.000Z',
        updatedAt: now,
      },
      {
        id: 'CAT003-03',
        key: 'spec-3',
        title: '小型设备',
        type: 'specification',
        code: 'SPEC-03',
        level: 1,
        parentId: 'CAT003',
        description: '重量<1吨且功率<10kW的设备',
        equipmentCount: 10,
        active: true,
        createdAt: '2024-01-01T00:00:00.000Z',
        updatedAt: now,
      },
    ],
  },
]

/**
 * 生成主数据记录
 */
export const mockMasterDataRecords: MasterDataRecord[] = Array.from({ length: 30 }, (_, i) => {
  const sources: DataSourceSystem[] = ['SAP', 'MES', 'ERP', 'manual']
  const statuses: MasterDataStatus[] = ['active', 'synced', 'pending_sync', 'sync_failed', 'inactive']
  const source = sources[i % sources.length]
  const status = statuses[i % statuses.length]

  return {
    id: `MD${String(i + 1).padStart(4, '0')}`,
    equipmentCode: `EQ-${String(i + 1).padStart(4, '0')}`,
    equipmentName: `设备-${String(i + 1).padStart(2, '0')}`,
    category: ['数控机床', '注塑机', '焊接机器人', '检测设备', '输送线'][i % 5],
    specification: `SPEC-${String((i % 3) + 1).padStart(2, '0')}-${Math.floor(Math.random() * 100)}`,
    manufacturer: ['西门子', '发那科', '三菱', '欧姆龙', 'ABB'][i % 5],
    technicalParams: {
      power: `${(5 + Math.random() * 95).toFixed(1)}kW`,
      weight: `${(0.5 + Math.random() * 15).toFixed(1)}t`,
      voltage: '380V',
      frequency: '50Hz',
    },
    sourceSystem: source,
    sourceId: `${source.toUpperCase()}-${String(i + 1).padStart(6, '0')}`,
    syncStatus: status,
    lastSyncTime: status === 'synced' || status === 'active' ? new Date(Date.now() - Math.random() * 86400000 * 7).toISOString() : null,
    dataQuality: Math.floor(75 + Math.random() * 25),
    validationErrors: status === 'sync_failed' ? ['编码格式不符合规范', '缺少必填字段:制造商'] : [],
    customFields: status === 'active' ? {
      warrantyExpiry: new Date(Date.now() + 86400000 * 365).toISOString().split('T')[0],
      maintenanceCycle: '30',
    } : {},
    createdAt: new Date(Date.now() - 86400000 * (30 + Math.random() * 60)).toISOString(),
    updatedAt: new Date(Date.now() - 86400000 * Math.random() * 7).toISOString(),
  }
})

/**
 * 数据标准
 */
export const mockDataStandards: DataStandard[] = [
  {
    id: 'STD001',
    standardCode: 'EQ-CODE-001',
    standardName: '设备编码规则',
    type: 'code',
    category: '基础数据',
    version: 'v2.0',
    status: 'published',
    description: '定义设备编码的生成规则和格式要求',
    rules: [
      {
        fieldName: 'equipmentCode',
        dataType: 'string',
        required: true,
        pattern: '^EQ-[0-9]{4}$',
        minLength: 7,
        maxLength: 7,
        defaultValue: 'EQ-0001',
      },
    ],
    applicableTo: ['设备台账', '主数据管理', '维修管理'],
    createdBy: '系统管理员',
    approvedBy: '数据治理委员会',
    effectiveDate: '2024-01-01',
    expiryDate: '2026-12-31',
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: now,
  },
  {
    id: 'STD002',
    standardCode: 'EQ-ATTR-001',
    standardName: '设备属性标准',
    type: 'attribute',
    category: '基础数据',
    version: 'v1.5',
    status: 'published',
    description: '定义设备基础属性的填写规范',
    rules: [
      {
        fieldName: 'manufacturer',
        dataType: 'string',
        required: true,
        enumValues: ['西门子', '发那科', '三菱', '欧姆龙', 'ABB', '库卡', '大族激光', '华工激光'],
      },
      {
        fieldName: 'originalValue',
        dataType: 'number',
        required: true,
        minValue: 0,
        defaultValue: 0,
      },
      {
        fieldName: 'purchaseDate',
        dataType: 'date',
        required: true,
      },
    ],
    applicableTo: ['设备台账', '资产管理'],
    createdBy: '数据管理员',
    approvedBy: '设备部经理',
    effectiveDate: '2024-01-01',
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: now,
  },
  {
    id: 'STD003',
    standardCode: 'EQ-VAL-001',
    standardName: '数据验证规则',
    type: 'validation',
    category: '数据质量',
    version: 'v1.0',
    status: 'published',
    description: '定义设备数据验证和质量检查规则',
    rules: [
      {
        fieldName: 'equipmentCode',
        dataType: 'string',
        required: true,
        pattern: '^[A-Z]{2}-[0-9]{4}$',
      },
      {
        fieldName: 'model',
        dataType: 'string',
        required: true,
        minLength: 2,
        maxLength: 50,
      },
      {
        fieldName: 'responsiblePerson',
        dataType: 'string',
        required: true,
      },
    ],
    applicableTo: ['主数据管理', '数据集成'],
    createdBy: '数据质量专员',
    approvedBy: '数据治理委员会',
    effectiveDate: '2024-01-01',
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: now,
  },
  {
    id: 'STD004',
    standardCode: 'EQ-FMT-001',
    standardName: '日期格式标准',
    type: 'format',
    category: '数据格式',
    version: 'v1.0',
    status: 'published',
    description: '定义系统内日期时间的统一格式标准',
    rules: [
      {
        fieldName: 'purchaseDate',
        dataType: 'date',
        required: false,
        pattern: '^\\d{4}-\\d{2}-\\d{2}$',
      },
      {
        fieldName: 'installDate',
        dataType: 'date',
        required: false,
        pattern: '^\\d{4}-\\d{2}-\\d{2}$',
      },
      {
        fieldName: 'warrantyDate',
        dataType: 'date',
        required: false,
        pattern: '^\\d{4}-\\d{2}-\\d{2}$',
      },
    ],
    applicableTo: ['所有模块'],
    createdBy: '系统架构师',
    approvedBy: '技术委员会',
    effectiveDate: '2024-01-01',
    createdAt: '2024-01-01T00:00:00.000Z',
    updatedAt: now,
  },
  {
    id: 'STD005',
    standardCode: 'EQ-CODE-002',
    standardName: '资产编码规则',
    type: 'code',
    category: '资产管理',
    version: 'v1.0',
    status: 'draft',
    description: '定义固定资产编码的生成规则',
    rules: [
      {
        fieldName: 'assetNo',
        dataType: 'string',
        required: true,
        pattern: '^AS-\\d{4}-\\d{4}$',
        minLength: 13,
        maxLength: 13,
      },
    ],
    applicableTo: ['资产管理'],
    createdBy: '资产会计',
    effectiveDate: '2024-06-01',
    createdAt: '2024-03-01T00:00:00.000Z',
    updatedAt: now,
  },
]

/**
 * 同步日志
 */
export const mockSyncLogs: SyncLog[] = Array.from({ length: 10 }, (_, i) => {
  const sources: DataSourceSystem[] = ['SAP', 'MES', 'ERP', 'PLM']
  const statuses: SyncLog['status'][] = ['success', 'success', 'success', 'failed', 'partial']
  const source = sources[i % sources.length]
  const status = statuses[i % statuses.length]
  const startTime = new Date(Date.now() - 86400000 * i * 2)

  return {
    id: `SYNC${String(i + 1).padStart(4, '0')}`,
    sourceSystem: source,
    syncType: i % 3 === 0 ? 'full' : 'incremental',
    startTime: startTime.toISOString(),
    endTime: new Date(startTime.getTime() + 60000 * (5 + Math.random() * 20)).toISOString(),
    status,
    totalRecords: 100 + Math.floor(Math.random() * 900),
    successRecords: status === 'failed' ? 0 : Math.floor(80 + Math.random() * 20) * 10,
    failedRecords: status === 'success' ? 0 : Math.floor(Math.random() * 20) * 10,
    errors: status === 'failed' || status === 'partial' ? [
      '连接超时: SAP系统响应缓慢',
      '数据格式错误: 字段长度超限',
      '必填字段缺失: 设备型号为空',
    ].slice(0, Math.floor(Math.random() * 3) + 1) : [],
    triggeredBy: i % 2 === 0 ? '系统自动' : `管理员-${String((i % 5) + 1)}`,
    createdAt: startTime.toISOString(),
  }
})

/**
 * 数据质量报告
 */
export const mockDataQualityReports: DataQualityReport[] = Array.from({ length: 5 }, (_, i) => {
  const reportDate = new Date(Date.now() - 86400000 * i * 7)

  const issueTypes: DataQualityReport['issues'][0]['type'][] = ['missing', 'invalid', 'duplicate', 'inconsistent']

  return {
    id: `DQR${String(i + 1).padStart(4, '0')}`,
    reportDate: reportDate.toISOString().split('T')[0],
    totalRecords: 100 + i * 10,
    validRecords: Math.floor((90 - i * 2) + Math.random() * 5),
    invalidRecords: Math.floor((10 + i * 2) - Math.random() * 5),
    completenessRate: parseFloat((95 - i * 1.5 - Math.random() * 2).toFixed(2)),
    accuracyRate: parseFloat((92 - i * 1 - Math.random() * 3).toFixed(2)),
    consistencyRate: parseFloat((88 - i * 2 - Math.random() * 2).toFixed(2)),
    issues: [
      {
        type: 'missing' as const,
        field: 'manufacturer',
        count: Math.floor(Math.random() * 5),
        examples: ['EQ-0012', 'EQ-0025', 'EQ-0038'],
      },
      {
        type: 'invalid' as const,
        field: 'equipmentCode',
        count: Math.floor(Math.random() * 3),
        examples: ['EQ-123', 'EQ-ABCD', 'EQ-12'],
      },
      {
        type: 'duplicate' as const,
        field: 'specification',
        count: Math.floor(Math.random() * 4),
        examples: ['SPEC-01-23', 'SPEC-02-45'],
      },
      {
        type: 'inconsistent' as const,
        field: 'originalValue',
        count: Math.floor(Math.random() * 6),
        examples: ['负数原值', '原值为空', '格式错误'],
      },
    ].slice(0, Math.floor(Math.random() * 3) + 1) as DataQualityReport['issues'],
    createdAt: reportDate.toISOString(),
  }
})
